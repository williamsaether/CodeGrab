// License: MIT
// Author: Anton Medvedev <anton@medv.io>
// Source: https://github.com/antonmedv/finder
"use strict";var finder=(()=>{var c=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var $=Object.prototype.hasOwnProperty;var x=(e,t)=>{for(var n in t)c(e,n,{get:t[n],enumerable:!0})},O=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of L(t))!$.call(e,i)&&i!==n&&c(e,i,{get:()=>t[i],enumerable:!(r=b(t,i))||r.enumerable});return e};var v=e=>O(c({},"__esModule",{value:!0}),e);var _={};x(_,{attr:()=>g,className:()=>C,finder:()=>k,idName:()=>N,tagName:()=>E});var D=new Set(["role","name","aria-label","rel","href"]);function g(e,t){let n=D.has(e);n||=e.startsWith("data-")&&f(e);let r=f(t)&&t.length<100;return r||=t.startsWith("#")&&f(t.slice(1)),n&&r}function N(e){return f(e)}function C(e){return f(e)}function E(e){return!0}function k(e,t){if(e.nodeType!==Node.ELEMENT_NODE)throw new Error("Can't generate CSS selector for non-element node type.");if(e.tagName.toLowerCase()==="html")return"html";let n={root:document.body,idName:N,className:C,tagName:E,attr:g,timeoutMs:1e3,seedMinLength:3,optimizedMinLength:2,maxNumberOfPathChecks:1/0},r=new Date,i={...n,...t},a=I(i.root,n),o,s=0;for(let p of P(e,i,a)){if(new Date().getTime()-r.getTime()>i.timeoutMs||s>=i.maxNumberOfPathChecks){let y=z(e,a);if(!y)throw new Error(`Timeout: Can't find a unique selector after ${i.timeoutMs}ms`);return u(y)}if(s++,m(p,a)){o=p;break}}if(!o)throw new Error("Selector was not found.");let l=[...S(o,e,i,a,r)];return l.sort(d),l.length>0?u(l[0]):u(o)}function*P(e,t,n){let r=[],i=[],a=e,o=0;for(;a&&a!==n;){let s=q(a,t);for(let l of s)l.level=o;if(r.push(s),a=a.parentElement,o++,i.push(...M(r)),o>=t.seedMinLength){i.sort(d);for(let l of i)yield l;i=[]}}i.sort(d);for(let s of i)yield s}function f(e){if(/^[a-z\-]{3,}$/i.test(e)){let t=e.split(/-|[A-Z]/);for(let n of t)if(n.length<=2||/[^aeiou]{4,}/i.test(n))return!1;return!0}return!1}function q(e,t){let n=[],r=e.getAttribute("id");r&&t.idName(r)&&n.push({name:"#"+CSS.escape(r),penalty:0});for(let o=0;o<e.classList.length;o++){let s=e.classList[o];t.className(s)&&n.push({name:"."+CSS.escape(s),penalty:1})}for(let o=0;o<e.attributes.length;o++){let s=e.attributes[o];t.attr(s.name,s.value)&&n.push({name:`[${CSS.escape(s.name)}="${CSS.escape(s.value)}"]`,penalty:2})}let i=e.tagName.toLowerCase();if(t.tagName(i)){n.push({name:i,penalty:5});let o=h(e,i);o!==void 0&&n.push({name:T(i,o),penalty:10})}let a=h(e);return a!==void 0&&n.push({name:A(i,a),penalty:50}),n}function u(e){let t=e[0],n=t.name;for(let r=1;r<e.length;r++){let i=e[r].level||0;t.level===i-1?n=`${e[r].name} > ${n}`:n=`${e[r].name} ${n}`,t=e[r]}return n}function w(e){return e.map(t=>t.penalty).reduce((t,n)=>t+n,0)}function d(e,t){return w(e)-w(t)}function h(e,t){let n=e.parentNode;if(!n)return;let r=n.firstChild;if(!r)return;let i=0;for(;r&&(r.nodeType===Node.ELEMENT_NODE&&(t===void 0||r.tagName.toLowerCase()===t)&&i++,r!==e);)r=r.nextSibling;return i}function z(e,t){let n=0,r=e,i=[];for(;r&&r!==t;){let a=r.tagName.toLowerCase(),o=h(r,a);if(o===void 0)return;i.push({name:T(a,o),penalty:NaN,level:n}),r=r.parentElement,n++}if(m(i,t))return i}function A(e,t){return e==="html"?"html":`${e}:nth-child(${t})`}function T(e,t){return e==="html"?"html":`${e}:nth-of-type(${t})`}function*M(e,t=[]){if(e.length>0)for(let n of e[0])yield*M(e.slice(1,e.length),t.concat(n));else yield t}function I(e,t){return e.nodeType===Node.DOCUMENT_NODE?e:e===t.root?e.ownerDocument:e}function m(e,t){let n=u(e);switch(t.querySelectorAll(n).length){case 0:throw new Error(`Can't select any node with this selector: ${n}`);case 1:return!0;default:return!1}}function*S(e,t,n,r,i){if(e.length>2&&e.length>n.optimizedMinLength)for(let a=1;a<e.length-1;a++){if(new Date().getTime()-i.getTime()>n.timeoutMs)return;let s=[...e];s.splice(a,1),m(s,r)&&r.querySelector(u(s))===t&&(yield s,yield*S(s,t,n,r,i))}}return v(_);})(); window.finder = finder.finder
